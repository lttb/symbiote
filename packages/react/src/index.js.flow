/* @flow */

import React from 'react'
import type {ComponentType, ElementConfig} from 'react';

declare class RegisteredComponent<P, D> extends React.Component<P> {
    static defaultProps: D;
}

type Config<Props, DefaultProps> = ElementConfig<Class<RegisteredComponent<Props, DefaultProps>>>

type MergeProps<OwnProps, ContextProps> = Config<
    OwnProps,
    $ObjMapi<ContextProps, <K>(K) => $ElementType<OwnProps, K>>
>

declare export function createRegistry(): {
    RegistryProvider: ComponentType<{}>,
    RegistryContext: React$Context<{}>,
    registry: {},
    register: <BaseComponent>(BaseComponent) => (
        <InterfaceComponent>(InterfaceComponent) => ComponentType<MergeProps<
            ElementConfig<InterfaceComponent>,
            $ElementType<InterfaceComponent & {contextProps: {}}, 'contextProps'>
        >>
    )
};
